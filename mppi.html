<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Model Predictive Path Integral Control</title>
        <meta
            name="description"
            content="Model Predictive Path Integral Control"
        />
        <link rel="stylesheet" href="style.css" />
                <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
                    </head>
    <body>
        <div class="container">
            <header>
                <div class="profile">
                    <a href="index.html">
                        <img
                            src="athu.jpg"
                            alt="atharva's photo"
                            class="profile-img"
                        />
                        <h1 class="site-title">KSAGAR.SITE</h1>
                    </a>
                </div>
                <nav class="nav-links">
                    <a
                        href="index.html"
                        class="nav-link "
                        >about</a
                    >
                    <a
                        href="blog.html"
                        class="nav-link active"
                        >blog</a
                    >
                    <a
                        href="uses.html"
                        class="nav-link "
                        >uses</a
                    >
                    <a
                        href="media.html"
                        class="nav-link "
                        >media</a
                    >
                </nav>
            </header>

            <main>
                <section class="content">
                    <h2 class="section-title">Model Predictive Path
Integral Control</h2>
                                        <p class="post-date">Mar 19,
2025</p>
                                                            <nav id="TOC" role="doc-toc">
                        <ul>
                        <li><a
                        href="#model-predictive-path-integral-control"
                        id="toc-model-predictive-path-integral-control">Model
                        Predictive Path Integral Control</a>
                        <ul>
                        <li><a href="#introduction-to-mpc"
                        id="toc-introduction-to-mpc">Introduction to
                        MPC</a></li>
                        <li><a href="#mppi-a-stochastic-approach"
                        id="toc-mppi-a-stochastic-approach">MPPI: A
                        Stochastic Approach</a></li>
                        <li><a href="#mathematical-formulation"
                        id="toc-mathematical-formulation">Mathematical
                        Formulation</a></li>
                        </ul></li>
                        </ul>
                    </nav>
                                        <h1
                                        id="model-predictive-path-integral-control">Model
                                        Predictive Path Integral
                                        Control</h1>
                                        <h2
                                        id="introduction-to-mpc">Introduction
                                        to MPC</h2>
                                        <p>Model Predictive Control
                                        (MPC) is a control method with
                                        the following key
                                        characteristics: - Computes
                                        control action by solving an
                                        optimization problem at each
                                        time step - At each time step,
                                        we solve an optimization problem
                                        over a finite prediction horizon
                                        to obtain a sequence of control
                                        inputs - Uses a model of the
                                        system to predict future
                                        states</p>
                                        <h2
                                        id="mppi-a-stochastic-approach">MPPI:
                                        A Stochastic Approach</h2>
                                        <p>MPPI (Model Predictive Path
                                        Integral) is a variant of MPC
                                        that uses stochastic
                                        optimization to compute control
                                        actions, instead of solving a
                                        deterministic optimization
                                        problem.</p>
                                        <h3
                                        id="key-components-affecting-controller-performance">Key
                                        Components Affecting Controller
                                        Performance</h3>
                                        <h4 id="trajectory">1.
                                        Trajectory</h4>
                                        <ul>
                                        <li>A sequence of states that a
                                        system passes through over
                                        time</li>
                                        <li>In MPPI, we sample multiple
                                        trajectories, evaluate the cost
                                        associated with each trajectory,
                                        and then use it to determine the
                                        optimal control</li>
                                        <li>This sampling approach
                                        allows MPPI to handle non-linear
                                        dynamics and complex cost
                                        functions</li>
                                        </ul>
                                        <h4 id="the-horizon">2. The
                                        Horizon</h4>
                                        <ul>
                                        <li>The number of time steps
                                        over which future trajectories
                                        are considered in the
                                        optimization problem</li>
                                        <li>The optimization problem
                                        tries to find the sequence of
                                        control actions over this
                                        horizon that minimizes the
                                        expected cost</li>
                                        <li>Trade-offs:
                                        <ul>
                                        <li>If too short: not enough
                                        foresight to make good
                                        decisions</li>
                                        <li>If too long: computationally
                                        complex and expensive</li>
                                        </ul></li>
                                        </ul>
                                        <h3
                                        id="mppi-algorithm-overview">MPPI
                                        Algorithm Overview</h3>
                                        <p>MPPI samples multiple control
                                        trajectories and computes the
                                        expected cost for each
                                        trajectory. The control action
                                        is then selected based on the
                                        weighted average of these
                                        trajectories, with weights
                                        determined by the relative
                                        costs.</p>
                                        <h2
                                        id="mathematical-formulation">Mathematical
                                        Formulation</h2>
                                        <h3
                                        id="objective-functions">Objective
                                        Functions</h3>
                                        <p>For a system with state
                                        <em>x</em> and control
                                        <em>u</em>, the objective is to
                                        minimize the expected cost over
                                        a finite horizon T:</p>
                                        <p><span
                                        class="math display">\[J(u) =
                                        \mathbb{E} \left[
                                        \sum_{t=0}^{T-1} c(x_t, u_t)
                                        \right]\]</span></p>
                                        <p>Where: - <span
                                        class="math inline">\(c(x_t,
                                        u_t)\)</span> is the
                                        instantaneous cost at time step
                                        <span
                                        class="math inline">\(t\)</span>
                                        - <span
                                        class="math inline">\(T\)</span>
                                        is the prediction horizon -
                                        <span
                                        class="math inline">\(\mathbb{E}[\cdot]\)</span>
                                        denotes expectation</p>
                                        <h3 id="key-equations">Key
                                        Equations</h3>
                                        <p><strong>State Transition
                                        Equation:</strong><br />
                                        <span
                                        class="math display">\[x_{t+1} =
                                        f(x_t, u_t) + w_t\]</span></p>
                                        <p>Where <span
                                        class="math inline">\(f(x_t,
                                        u_t)\)</span> is the system
                                        dynamics model and <span
                                        class="math inline">\(w_t\)</span>
                                        is the process noise.</p>
                                        <p><strong>Control
                                        Trajectory:</strong><br />
                                        <span class="math display">\[u^k
                                        = (u_0^k, u_1^k, \ldots,
                                        u_{T-1}^k)\]</span></p>
                                        <p>Representing the k-th sampled
                                        control sequence over the
                                        horizon.</p>
                                        <p><strong>Cost of Sampled
                                        Trajectory:</strong><br />
                                        <span class="math display">\[S^k
                                        = \sum_{t=0}^{T-1} c(x_t^k,
                                        u_t^k)\]</span></p>
                                        <p>The total cost associated
                                        with the k-th trajectory.</p>
                                        <p><strong>Quadratic Cost
                                        Function (commonly
                                        used):</strong><br />
                                        <span
                                        class="math display">\[c(x_t,
                                        u_t) = x_t^T Q x_t + u_t^T R
                                        u_t\]</span></p>
                                        <p>Where <span
                                        class="math inline">\(Q\)</span>
                                        and <span
                                        class="math inline">\(R\)</span>
                                        are weight matrices for state
                                        and control costs
                                        respectively.</p>
                                        <h3
                                        id="computing-the-optimal-control">Computing
                                        the Optimal Control</h3>
                                        <p>The optimal control input is
                                        computed as a weighted average
                                        of the sampled control
                                        trajectories:</p>
                                        <p><span
                                        class="math display">\[u^* =
                                        \sum_{k=1}^K w^k
                                        u_k\]</span></p>
                                        <p>With weights determined by
                                        the relative costs:</p>
                                        <p><span
                                        class="math display">\[w^k =
                                        \frac{\exp(-\lambda
                                        S^k)}{\sum_{j=1}^K \exp(-\lambda
                                        S^j)}\]</span></p>
                                        <p>Where <span
                                        class="math inline">\(\lambda\)</span>
                                        is a temperature parameter that
                                        affects the selectivity of the
                                        weighting.</p>

                    <div class="social-links">
                        <a href="https://x.com/k7agar" class="social-link">x/k7agar</a>
                        <a
                            href="https://github.com/vovw"
                            target="_blank"
                            class="social-link"
                            >git</a
                        >
                        <a
                            href="https://www.youtube.com/@wtfvoidz"
                            target="_blank"
                            class="social-link"
                            >tube</a
                        >
                    </div>
                </section>

                <aside class="sidebar">
                    <div class="sidebar-content">
                        <h3 class="sidebar-title">ON THIS PAGE</h3>
                        <ul class="sidebar-nav">
                                                    </ul>
                    </div>
                </aside>
            </main>
        </div>
    </body>
</html>